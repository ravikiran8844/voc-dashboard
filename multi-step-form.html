<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Multi-Step Modal Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    .modal-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: flex; align-items: center; justify-content: center;
      z-index: 999;
    }
    .modal {
      background: #fff;
      padding: 20px 30px;
      border-radius: 8px;
      width: 400px;
      max-width: 90%;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      position: relative;
    }
    .step {
      display: none;
    }
    .step.active {
      display: block;
    }
    .input-box {
      width: 40px;
      height: 40px;
      text-align: center;
      font-size: 1.2rem;
      margin: 4px;
    }
    .input-container {
      display: flex;
      gap: 5px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .modal-header {
      font-size: 1.2rem;
      margin-bottom: 10px;
    }
    .button-group {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .btn-next {
      background-color: #4CAF50;
      color: white;
    }
    .btn-prev {
      background-color: #ccc;
      color: #333;
    }
    .btn-submit {
      background-color: #2196F3;
      color: white;
      width: 100%;
    }
  </style>
</head>
<body>

<!-- Trigger button -->
<button onclick="openModal()">Open Form</button>

<!-- Modal -->
<div class="modal-overlay" id="modal" style="display: none;">
  <div class="modal">
    
    <div id="step1" class="step active">
      <div class="modal-header">Step 1: Personal Info</div>
      <div>
        <label>Name</label><br>
        <input type="text" id="name" required><br><br>

        <label>Address</label><br>
        <textarea id="address" required></textarea><br><br>

        <label>Date of Birth</label><br>
        <input type="date" id="dob" required><br><br>

        <label>Gender</label><br>
        <input type="radio" name="gender" value="Male" checked> Male
        <input type="radio" name="gender" value="Female"> Female
        <input type="radio" name="gender" value="Other"> Other
      </div>

      <div class="button-group">
        <button class="btn btn-next" onclick="nextStep(1)">Next</button>
      </div>
    </div>

    <div id="step2" class="step">
      <div class="modal-header">Step 2: Contact Info</div>
      
      <label>Phone Number (10 digits)</label>
      <div class="input-container phone-group">
        <input type="text" maxlength="1" class="phone input-box" />
        <input type="text" maxlength="1" class="phone input-box" />
        <input type="text" maxlength="1" class="phone input-box" />
        <input type="text" maxlength="1" class="phone input-box" />
        <input type="text" maxlength="1" class="phone input-box" />
        <input type="text" maxlength="1" class="phone input-box" />
        <input type="text" maxlength="1" class="phone input-box" />
        <input type="text" maxlength="1" class="phone input-box" />
        <input type="text" maxlength="1" class="phone input-box" />
        <input type="text" maxlength="1" class="phone input-box" />
      </div>

      <br>

      <label>ZIP Code (6 digits)</label>
      <div class="input-container zip-group">
        <input type="text" maxlength="1" class="zip input-box" />
        <input type="text" maxlength="1" class="zip input-box" />
        <input type="text" maxlength="1" class="zip input-box" />
        <input type="text" maxlength="1" class="zip input-box" />
        <input type="text" maxlength="1" class="zip input-box" />
        <input type="text" maxlength="1" class="zip input-box" />
      </div>

      <div class="button-group">
        <button class="btn btn-prev" onclick="prevStep(2)">Previous</button>
        <button class="btn btn-next" onclick="nextStep(2)">Next</button>
      </div>
    </div>

    <div id="step3" class="step">
      <div class="modal-header">Step 3: OTP Verification</div>

      <label>Enter OTP</label>
      <div class="input-container otp-group">
        <input type="text" maxlength="1" class="otp input-box" />
        <input type="text" maxlength="1" class="otp input-box" />
        <input type="text" maxlength="1" class="otp input-box" />
        <input type="text" maxlength="1" class="otp input-box" />
      </div>

      <button class="btn btn-submit" onclick="submitForm()">Submit</button>
      <div class="button-group">
        <button class="btn btn-prev" onclick="prevStep(3)">Previous</button>
      </div>
    </div>

    <div id="step4" class="step">
      <div class="modal-header">Success!</div>
      <p>Your details have been submitted successfully.</p>
      <button class="btn btn-submit" onclick="closeModal()">Close</button>
    </div>

  </div>
</div>

<script>
  const modal = document.getElementById('modal');
  const otpInputs = [];
  const phoneInputs = [];
  const zipInputs = [];

  const openModal = () => {
    modal.style.display = 'flex';
  };

  const closeModal = () => {
    modal.style.display = 'none';
    document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
    document.getElementById('step1').classList.add('active');
  };

  const nextStep = (current) => {
    if (!validateStep(current)) return;
    document.getElementById(`step${current}`).classList.remove('active');
    document.getElementById(`step${current + 1}`).classList.add('active');
  };

  const prevStep = (current) => {
    document.getElementById(`step${current}`).classList.remove('active');
    document.getElementById(`step${current - 1}`).classList.add('active');
  };

  const validateStep = (step) => {
    if (step === 1) {
      const name = document.getElementById('name').value.trim();
      const address = document.getElementById('address').value.trim();
      const dob = document.getElementById('dob').value.trim();
      if (!name || !address || !dob) {
        alert("Please fill all personal info fields!");
        return false;
      }
    }
    if (step === 2) {
      const phoneFilled = phoneInputs.every(input => input.value !== "");
      const zipFilled = zipInputs.every(input => input.value !== "");
      if (!phoneFilled || !zipFilled) {
        alert("Please enter all digits for phone and zip!");
        return false;
      }
    }
    return true;
  };

  const submitForm = () => {
    const name = document.getElementById('name').value.trim();
    const address = document.getElementById('address').value.trim();
    const dob = document.getElementById('dob').value.trim();
    const gender = document.querySelector('input[name="gender"]:checked').value;

    const phoneValue = phoneInputs.map(input => input.value).join("");
    const zipValue = zipInputs.map(input => input.value).join("");
    const otpValue = otpInputs.map(input => input.value).join("");

    if (otpValue.length < 4) {
      alert("Please enter complete OTP!");
      return;
    }

    console.log("Name:", name);
    console.log("Address:", address);
    console.log("DOB:", dob);
    console.log("Gender:", gender);
    console.log("Phone Number:", phoneValue);
    console.log("ZIP Code:", zipValue);
    console.log("OTP:", otpValue);

    document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
    document.getElementById('step4').classList.add('active');
  };

  const createInputHandlers = (inputs) => {
    inputs.forEach((input, index) => {
      input.addEventListener("input", (e) => {
        const val = e.target.value;
        if (/^\d$/.test(val)) {
          if (index < inputs.length - 1) inputs[index + 1].focus();
        } else {
          e.target.value = "";
        }
      });

      input.addEventListener("keydown", (e) => {
        const key = e.key;

        if (!/^\d$/.test(key) && key !== "Backspace" && key !== "Delete" && key !== "ArrowLeft" && key !== "ArrowRight" && !e.metaKey) {
          e.preventDefault();
        }

        if (key === "Backspace" || key === "Delete") {
          e.preventDefault();
          if (input.value !== "") {
            input.value = "";
          } else if (index > 0) {
            inputs[index - 1].focus();
            inputs[index - 1].value = "";
          }
        }

        if (key === "ArrowLeft" && index > 0) inputs[index - 1].focus();
        if (key === "ArrowRight" && index < inputs.length - 1) inputs[index + 1].focus();
      });

      input.addEventListener("paste", (e) => {
        e.preventDefault();
        const text = e.clipboardData.getData("text").trim();
        if (!/^\d+$/.test(text)) return;
        const chars = [...text];
        chars.forEach((char, i) => {
          if (inputs[i]) inputs[i].value = char;
        });
        if (inputs[chars.length - 1]) {
          inputs[Math.min(chars.length, inputs.length) - 1].focus();
        }
      });
    });
  };

  document.addEventListener("DOMContentLoaded", () => {
    otpInputs.push(...document.querySelectorAll(".otp"));
    phoneInputs.push(...document.querySelectorAll(".phone"));
    zipInputs.push(...document.querySelectorAll(".zip"));

    createInputHandlers(otpInputs);
    createInputHandlers(phoneInputs);
    createInputHandlers(zipInputs);
  });
</script>

</body>
</html>
